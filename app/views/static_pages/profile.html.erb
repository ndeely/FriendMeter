<%
@name = @b1 ? @user.fname.to_s + " " + @user.lname.to_s : @user.username.to_s
@name = (@name.eql? " ") ? @user.username : @name
%>
<div class="profile">
    <h1><%= @name %></h1>
    <%= image_tag("pic-placeholder.png") %>
    
    <div class="bio">
        <h2>Bio</h2>
        <p><%= @b1 ? @user.bio : "Add this user as a friend to see their bio" %></p>
    </div>

    <% if !@b1 %>
        <!-- button to add friend -->
    <% end %>

    <div class="events">
        <h2>Events</h2>
        <% if @events.size == 0 %>
            <p>This user has not created any events.</p>
        <% else %>
            <table>
                <thead>
                <tr>
                    <th>Event ID</th>
                    <th>Name</th>
                    <th>Description</th>
                    <th>Date</th>
                    <th>Time</th>
                    <th>Pic</th>
                    <th>Public</th>
                    <th colspan="3"></th>
                </tr>
                </thead>
            
                <tbody>
                    <% @events.each do |event| %>
                        <tr>
                            <td><%= event.id %></td>
                            <td><%= event.name %></td>
                            <td><%= event.description %></td>
                            <td><%= event.date %></td>
                            <td><%= event.time.strftime("%I:%M %p") %></td>
                            <td><%= image_tag(event.pic) %></td>
                            <td class="toggle"><%= !event.private ? image_tag("tick.png") : image_tag("red-x.png") %></td>
                            <td>
                                <button class="btn1" onclick="window.location.href='<%= event %>'">
                                    <span class="circle" aria-hidden="true">
                                    <span class="icon arrow"></span>
                                    </span>
                                    <span class="button-text">View</span>
                                </button>
                            </td>
                            <% if user_signed_in? && current_user.id == @user.id %>
                                <td>
                                    <button class="btn1" onclick="window.location.href='<%= edit_event_path(event) %>">
                                        <span class="circle" aria-hidden="true">
                                        <span class="icon arrow"></span>
                                        </span>
                                        <span class="button-text">Edit</span>
                                    </button>
                                </td>
                                <td><%= link_to 'Delete', event, method: :delete, data: { confirm: 'Are you sure?' } %></td>
                            <% end %>
                        </tr>
                    <% end %>
                </tbody>
            </table>
        <% end %>
    </div>
    <% if user_signed_in? && current_user.id == @user.id %>
        <td>
            <button class="btn1" onclick="window.location.href='<%= edit_user_registration_path %>'">
                <span class="circle" aria-hidden="true">
                <span class="icon arrow"></span>
                </span>
                <span class="button-text">Edit Profile</span>
            </button>
        </td>
    <% end %>
</div>
